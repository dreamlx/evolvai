# EvolvAI 文档组织结构规范

**版本**: 1.0
**更新日期**: 2025-10-26
**状态**: ✅ 规范确立

---

## 📁 **文档目录结构**

```
docs/
├── 📋 product/                      # 产品相关文档
│   ├── definition/                  # 产品定义
│   │   ├── product-definition-v1.md
│   │   └── discussion-summary-2025-10-26.md
│   ├── roadmap/                     # 路线图
│   │   ├── roadmap-overview.md
│   │   └── phase-timeline.md
│   ├── epics/                       # Epic文档
│   │   ├── epic-001-behavior-constraints/
│   │   │   ├── README.md
│   │   │   ├── feature-001-execution-plan.md
│   │   │   └── feature-002-safe-tools.md
│   │   └── epic-002-tool-intelligence/
│   └── specs/                       # 产品规格
│       ├── execution-plan-spec.md
│       ├── safe-search-spec.md
│       └── tpst-metrics-spec.md
│
├── 🏗️ development/                  # 开发相关文档
│   ├── sprints/                     # Sprint 管理
│   │   ├── current/                 # 当前 Sprint 活跃文档
│   │   │   ├── sprint-001-mvp-week1.md           # Sprint 总览
│   │   │   ├── phase-1-implementation-plan.md    # Phase 实现计划
│   │   │   ├── story-1.1-tdd-plan.md             # Story TDD 计划（执行文档）
│   │   │   ├── story-1.1-completion-summary.md   # Story 完成总结
│   │   │   └── daily-updates/                    # 每日进度更新
│   │   └── completed/               # 已完成 Sprint（包含所有相关文档）
│   │       └── sprint-001/
│   │           ├── sprint-001-mvp-week1.md
│   │           ├── story-*.md       # 该 Sprint 的所有 Story 文档
│   │           └── summary.md
│   ├── tasks/                       # Task文档
│   │   ├── backlog/
│   │   └── in-progress/
│   ├── architecture/                # 架构文档
│   │   ├── technical-architecture.md
│   │   ├── behavior-engineering.md
│   │   └── adrs/                    # Architecture Decision Records
│   │       ├── 001-patch-first.md
│   │       ├── 002-git-worktree.md
│   │       └── 003-tpst-metrics.md
│   └── standards/                   # 开发规范
│       ├── coding-standards.md
│       ├── git-workflow.md
│       └── definition-of-done.md
│
├── 🧪 testing/                      # 测试文档
│   ├── plans/                      # 测试计划
│   │   └── mvp-test-plan.md
│   ├── benchmarks/                  # 基线测试
│   │   ├── search-baseline.md
│   │   └── tpst-baseline.md
│   ├── standards/                   # 测试标准和方法论
│   │   └── tdd-refactoring-guidelines.md
│   └── reports/
│       └── sprint-001-test-report.md
│
├── 📚 knowledge/                    # 知识库
│   ├── research/                    # 研究和分析文档
│   │   ├── parallel-development-analysis.md      # 技术研究
│   │   └── ai-behavior-engineering.md            # 技术研究
│   └── lessons-learned/            # 经验教训
│       └── sprint-retrospectives/
│
├── 🚀 deployment/                   # 部署文档
│   ├── setup-guide.md
│   └── mcp-integration.md
│
├── 📖 api/                          # API文档
│   ├── mcp-tools.md
│   └── execution-plan-api.md
│
├── 📝 templates/                    # 文档模板
│   ├── epic-template.md
│   ├── feature-template.md
│   ├── story-template.md
│   ├── task-template.md
│   ├── adr-template.md
│   ├── decision-template.md        # 决策文档模板
│   └── sprint-template.md
│
└── 🗃️ archive/                     # 归档文档
    └── 2025-10/
```

---

### **决策文档分布说明**

决策文档使用 `decision-` 前缀 + frontmatter 标记，按领域就近放置：

```
├── product/definition/
│   └── decision-tpst-as-core-metric.md           # 产品决策
├── development/architecture/
│   ├── adrs/                                      # 架构决策（ADR格式）
│   └── decision-pydantic-rationale.md            # 技术选型决策
├── development/standards/
│   └── definition-of-done.md                         # 完成定义
└── knowledge/research/
    └── decision-parallel-development.md          # 研究型决策
```

---

## 📝 **文档命名规范**

### **Epic文档**
```
格式: epic-{编号}-{名称}/
示例: epic-001-behavior-constraints/
      epic-002-tool-intelligence/
```

### **Feature文档**
```
格式: feature-{编号}-{名称}.md
示例: feature-001-execution-plan.md
      feature-002-safe-search.md
```

### **Story文档**
```
格式: story-{编号}-{简短描述}.md
示例: story-001-implement-execution-plan.md
      story-002-safe-search-wrapper.md
```

### **Task文档**
```
格式: task-{story编号}.{任务编号}-{描述}.md
示例: task-001.1-execution-plan-schema.md
      task-001.2-validation-logic.md
```

### **ADR文档**
```
格式: {编号}-{决策标题}.md
示例: 001-patch-first-architecture.md
      002-git-worktree-strategy.md
```

### **决策文档（非ADR）**
```
格式: decision-{主题}.md
位置: 按领域就近放置，使用 frontmatter 标记

示例:
- product/definition/decision-tpst-as-core-metric.md
- development/architecture/decision-pydantic-rationale.md
- development/standards/definition-of-done.md
- knowledge/research/decision-parallel-development.md

Frontmatter 必需字段:
---
type: decision
category: product | architecture | technical | process
status: proposed | approved | deprecated
date: 2025-10-28
---
```

### **Story 相关文档**
```
TDD 计划:
格式: story-{编号}-tdd-plan.md
示例: story-1.1-tdd-plan.md
      story-1.2-tdd-plan.md

完成总结:
格式: story-{编号}-completion-summary.md
示例: story-1.1-completion-summary.md
      story-1.2-completion-summary.md

位置: 开发中放在 sprints/current/
      完成后移动到 sprints/completed/{sprint-id}/
```

### **Phase 计划文档**
```
格式: phase-{编号}-implementation-plan.md
示例: phase-1-implementation-plan.md
      phase-2-implementation-plan.md

完成报告:
格式: phase-{编号}-completion-report.md
示例: phase-0-completion-report.md
      phase-1-completion-report.md

位置: 开发中放在 sprints/current/
      完成后移动到 sprints/completed/ 或 archive/
```

### **Sprint文档**
```
格式: sprint-{编号}-{描述}.md
示例: sprint-001-mvp-week1.md
      sprint-002-mvp-week2.md
```

---

## 📋 **Frontmatter 元数据规范**

### **决策文档元数据**
```yaml
---
type: decision                    # 必需: 文档类型
category: architecture            # 必需: 决策类别
  # 可选值: architecture | technical | product | process
status: approved                  # 必需: 决策状态
  # 可选值: proposed | approved | deprecated
date: 2025-10-28                 # 必需: 决策日期
decision_id: ADR-001             # 可选: 决策编号（ADR必需）
supersedes: ADR-000              # 可选: 替代的决策
related: [ADR-002, ADR-003]      # 可选: 相关决策
---
```

### **Story 文档元数据**
```yaml
---
epic: epic-001-behavior-constraints    # 必需: 所属 Epic
story: story-1.1                       # 必需: Story 编号
phase: phase-1                         # 必需: 所属 Phase
status: in-progress                    # 必需: 状态
  # 可选值: planning | in-progress | completed | archived
start_date: 2025-10-26                # 必需: 开始日期
completion_date: 2025-10-28           # 可选: 完成日期
---
```

### **通用元数据建议**
```yaml
---
author: Claude + Human            # 可选: 作者
reviewers: []                     # 可选: 审阅者
tags: [tdd, validation, pydantic] # 可选: 标签
last_updated: 2025-10-28          # 可选: 最后更新
---
```

### **元数据使用场景**
- 🔍 **搜索**: `grep -rl "category: architecture" docs/`
- 📊 **统计**: 统计各类型文档数量
- 🔗 **关联**: 自动生成文档关系图
- 📋 **过滤**: 按状态、类别筛选文档

---

## 📋 **文档模板使用指南**

### **Epic模板位置**
`docs/templates/epic-template.md`

### **使用方式**
```bash
# 创建新Epic
cp docs/templates/epic-template.md docs/product/epics/epic-003-new-feature/README.md
```

### **模板继承关系**
```
Epic (史诗)
 └── Feature (功能)
      └── Story (用户故事)
           └── Task (任务)
```

---

## 🔄 **文档生命周期管理**

### **创建阶段**
1. 使用模板创建文档
2. 填写基本信息
3. 在相应目录存放

### **开发阶段**
1. 更新状态（Planning/In Progress/Review/Done）
2. 记录进度和阻塞
3. 关联相关文档

### **完成阶段**
1. 标记为 Done
2. 根据文档类型选择归档位置：

   **Story 文档** → `sprints/completed/{sprint-id}/`
   - story-{编号}-tdd-plan.md
   - story-{编号}-completion-summary.md
   - 相关的所有 Story 执行文档

   **Sprint 文档** → `sprints/completed/{sprint-id}/`
   - sprint-{编号}-{描述}.md
   - 该 Sprint 的所有 Story 文档
   - Sprint 总结报告

   **Phase 文档** → `archive/{年月}/` 或 `sprints/completed/`
   - phase-{编号}-implementation-plan.md
   - phase-{编号}-completion-report.md

   **Epic 文档** → 保持原位，更新状态
   - Epic README.md 更新状态为 [COMPLETE]
   - Feature 文档保持在 product/epics/ 下

   **决策文档** → 永不归档（更新状态即可）
   - ADRs 保持在 development/architecture/adrs/
   - 其他决策文档保持原位，更新 status: deprecated

3. 更新相关文档链接和引用

### **归档规则**

**completed/ - 近期完成的 Sprint**
- 时间范围: 近 1-3 个月的 Sprint
- 内容: Sprint 及其所有 Story 文档
- 目的: 便于快速查阅近期工作
- 清理: 3个月后移动到 archive/

**archive/ - 长期归档**
- 时间范围: 3个月以前的文档
- 内容:
  - 旧的 Sprint 文档（从 completed/ 移过来）
  - Phase 完成报告
  - 过时的产品文档
- 组织: 按年月分组（archive/2025-10/）
- 目的: 长期保存但不常访问

**永不归档**
- ADRs（architecture/adrs/） - 永久保留，更新状态
- 其他决策文档 - 保持原位，更新 status
- Epic README - 保持原位，更新 status
- 产品定义 - 保持原位，创建新版本

---

## 🎯 **快速查找指南**

### **我想找...**

**产品定义**
→ `docs/product/definition/product-definition-v1.md`

**当前Sprint计划**
→ `docs/development/sprints/current/sprint-001-mvp-week1.md`

**技术架构决策**
→ `docs/development/architecture/adrs/`

**代码规范**
→ `docs/development/standards/`

**测试计划**
→ `docs/testing/plans/mvp-test-plan.md`

**API文档**
→ `docs/api/mcp-tools.md`

**文档模板**
→ `docs/templates/`

**决策文档（所有类型）**
→ 使用搜索脚本: `./scripts/find-decisions.sh all`
→ 或: `find docs -name "decision-*.md" -o -path "*/adrs/*.md"`

**架构决策（ADRs）**
→ `docs/development/architecture/adrs/`

**技术研究和分析**
→ `docs/knowledge/research/`

**已完成的 Story 文档**
→ `docs/development/sprints/completed/{sprint-id}/`

---

## 🚨 **重要规则**

### **禁止事项**
❌ 不要在项目根目录创建文档
❌ 不要随意创建新的顶级目录
❌ 不要使用中文目录名
❌ 不要混淆product/development分类

### **强制要求**
✅ 所有文档必须在docs/下
✅ 使用英文目录名和文件名
✅ 遵循命名规范
✅ 使用模板创建标准文档
✅ 及时更新文档状态
✅ 归档过时文档

---

## 📊 **文档状态标记**

### **状态标签**
```markdown
[DRAFT]      - 草稿阶段
[REVIEW]     - 审查中
[APPROVED]   - 已批准
[ACTIVE]     - 活跃使用
[DEPRECATED] - 已废弃
[ARCHIVED]   - 已归档
```

### **使用方式**
```markdown
# [DRAFT] Epic 001: Behavior Constraints
# [APPROVED] Product Definition v1.0
# [DEPRECATED] Old Architecture Design
```

---

## 🔧 **维护流程**

### **每日维护**
- 更新当前Sprint文档
- 更新Task状态
- 记录阻塞和进度

### **每周维护**
- 审查Sprint进度
- 更新Epic/Feature状态
- 归档完成的文档

### **每月维护**
- 清理archive/
- 审查文档质量
- 更新模板

---

## 💡 **最佳实践**

### **文档编写**
1. 使用清晰的标题层级
2. 添加目录导航
3. 链接相关文档
4. 保持简洁明了
5. 定期更新状态

### **目录组织**
1. 按功能分类而非时间
2. 保持层级不超过3层
3. 使用README.md作为目录入口
4. 定期清理冗余文档

### **版本控制**
1. 重要变更创建新版本
2. 使用Git标签标记里程碑
3. 保留历史版本在archive/

---

## 🤖 **AI助手遵守规则**

### **Claude Code必须遵守**
1. **创建文档时**：
   - 检查目标目录是否存在
   - 使用正确的命名规范
   - 从模板复制而非从零创建

2. **查找文档时**：
   - 先查看.structure.md了解组织
   - 使用快速查找指南定位
   - 检查文档状态标记

3. **更新文档时**：
   - 保持原有格式
   - 更新状态标记
   - 添加变更记录

4. **归档文档时**：
   - 标记[ARCHIVED]
   - 移动到archive/{年月}/
   - 更新引用链接

5. **创建决策文档时**：
   - 非 ADR 决策使用 decision- 前缀
   - 必须添加 frontmatter 元数据
   - 按领域就近放置（不是放在统一的 decisions/ 目录）
   - 使用决策文档模板: `docs/templates/decision-template.md`

6. **Story 完成时**：
   - 创建 story-{编号}-completion-summary.md
   - 将所有 Story 相关文档移动到 sprints/completed/{sprint-id}/
   - 包括: TDD plan, completion summary, 执行文档
   - 更新 Sprint 文档的链接

7. **使用 frontmatter 时**：
   - 决策文档必需字段: type, category, status, date
   - Story 文档建议字段: epic, story, phase, status
   - 使用标准格式（YAML）
   - 便于脚本化搜索和处理

### **禁止行为**
- ❌ 在根目录创建临时文档
- ❌ 创建不符合规范的目录
- ❌ 删除文档而不归档
- ❌ 混乱的命名方式

---

## 🔮 **未来改进计划**

### **国际化支持** [TODO]
- **需求**: 未来国际化时候文档系统需要考虑多语言纯净版本
- **当前状态**: 文档内容使用中文，文件名/目录名使用英文（混合模式）
- **计划**:
  - Phase 1: 保持当前混合模式，适合中文团队使用
  - Phase 2: 创建纯英文版本模板（`templates/en/`）
  - Phase 3: 考虑文档内容的i18n机制（如使用markdown的多语言方案）
- **触发条件**: 项目需要国际化支持或有海外贡献者加入时

### **其他改进**
- 文档质量检查工具（lint-docs）
- 自动化文档索引生成
- 文档搜索功能优化

---

## 📚 **参考资源**

- [GitFlow工作流](../development/standards/git-workflow.md)
- [文档模板集](../templates/)
- [ADR编写指南](../development/architecture/adrs/README.md)

---

**最后更新**: 2025-10-26
**维护者**: EvolvAI Team
**反馈渠道**: GitHub Issues